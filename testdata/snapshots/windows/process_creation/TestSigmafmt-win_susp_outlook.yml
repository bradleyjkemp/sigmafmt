title: Suspicious Execution from Outlook
description: Detects EnableUnsafeClientMailRules used for Script Execution from Outlook
level: high
status: experimental
falsepositives:
    - unknown
references:
    - https://github.com/sensepost/ruler
    - https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html
author: Markus Neis
date: 2018/12/27

logsource:
    category: process_creation
    product: windows
detection:
    clientMailRules:
        CommandLine: '*EnableUnsafeClientMailRules*'
    outlookExec:
        ParentImage: '*\outlook.exe'
        CommandLine: \\\\*\\*.exe
    condition: clientMailRules or outlookExec

id: e212d415-0e93-435f-9e1a-f29005bb4723
tags:
    - attack.execution
    - attack.t1059
    - attack.t1202

