title: Suspicious New Printer Ports in Registry (CVE-2020-1048)
description: Detects a new and suspicious printer port creation in Registry that could be an attempt to exploit CVE-2020-1048
level: high
status: experimental
falsepositives:
    - New printer port install on host
references:
    - https://windows-internals.com/printdemon-cve-2020-1048/
author: EagleEye Team, Florian Roth, NVISO
date: 2020/05/13
modified: 2020/09/06

logsource:
    product: windows
    category: registry_event
detection:
    selection:
        TargetObject|startswith: 'HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports'
        EventType:
            - SetValue
            - DeleteValue
            - CreateValue
        Details|contains:
            - '.dll'
            - '.exe'
            - '.bat'
            - '.com'
            - 'C:'
    condition: selection

id: 7ec912f2-5175-4868-b811-ec13ad0f8567
tags:
    - attack.defense_evasion
    - attack.execution
    - attack.persistence
    - attack.t1112

