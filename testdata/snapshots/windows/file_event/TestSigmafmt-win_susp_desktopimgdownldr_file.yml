title: Suspicious Desktopimgdownldr Target File
description: Detects a suspicious Microsoft desktopimgdownldr file creation that stores a file to a suspicious location or contains a file with a suspicious extension
level: high
status: experimental
falsepositives:
    - False positives depend on scripts and administrative tools used in the monitored environment
references:
    - https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/
    - https://twitter.com/SBousseaden/status/1278977301745741825
author: Florian Roth
date: 2020/07/03

logsource:
    product: windows
    category: file_event
detection:
    selection:
        Image|endswith: svchost.exe
        TargetFilename|contains: '\Personalization\LockScreenImage\'
    filter1:
        TargetFilename|contains: 'C:\Windows\'
    filter2:
        TargetFilename|contains:
            - '.jpg'
            - '.jpeg'
            - '.png'
    condition: selection and not filter1 and not filter2

id: fc4f4817-0c53-4683-a4ee-b17a64bc1039
fields:
    - CommandLine
    - ParentCommandLine
tags:
    - attack.defense_evasion
    - attack.t1105

