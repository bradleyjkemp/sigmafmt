title: Suspicious SQL Error Messages
description: Detects SQL error messages that indicate probing for an injection attack
level: high
status: experimental
falsepositives:
    - Application bugs
references:
    - http://www.sqlinjection.net/errors
author: Bjoern Kimminich
date: 2017/11/27
modified: 2020/09/01

logsource:
    category: application
    product: sql
detection:
    keywords:
        # Oracle
        - quoted string not properly terminated
        # MySQL
        - You have an error in your SQL syntax
        # SQL Server
        - Unclosed quotation mark
        # SQLite
        - 'near "*": syntax error'
        - SELECTs to the left and right of UNION do not have the same number of result columns
    condition: keywords

id: 8a670c6d-7189-4b1c-8017-a417ca84a086
tags:
    - attack.initial_access
    - attack.t1190

